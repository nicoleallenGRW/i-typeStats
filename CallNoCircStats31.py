# -*- coding: utf-8 -*-
"""
Created on Thu Aug  2 14:32:38 2018

@author: nallen
"""

# -*- coding: utf-8 -*-
#!/usr/bin/python2.7
#
# Recreating Web Managment reports for call no circ stats
# 
# Use XlsxWriter to create spreadsheet from SQL Query
# 
#

import psycopg2
import xlsxwriter
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase
from email.mime.text import MIMEText
from email.utils import formatdate
from email import encoders
from datetime import datetime



excelfile =  'test.xlsx'



#Set variables for email

emailhost = 'mail.'
emailport = '25'
emailsubject = 'CallNoCircStats'
emailmessage = '''Here are the Call NO. Circ stats for Main, Byram and Cos Cob.'''
emailfrom = 'nallen'
emailto = ['nallen']
 #''

try:
    conn = psycopg2.connect("dbname= user= host=port= password= sslmode=")
except psycopg2.Error as e:
    print ("Unable to connect to database: " + str(e))
    
cursor = conn.cursor()
cursor.execute(open("CallNoCircStats.sql","r",).read())
rows = cursor.fetchall()
conn.close()


workbook = xlsxwriter.Workbook(excelfile, {'remove_timezone': True})

worksheet = workbook.add_worksheet('Total')

worksheet.set_landscape()
worksheet.hide_gridlines(0)



eformat= workbook.add_format({'text_wrap': True, 'valign': 'top' , 'num_format': 'mm/dd/yy'})
eformatlabel= workbook.add_format({'text_wrap': False, 'valign': 'top', 'bold': True})

worksheet.set_header('CallNoCircStats')

#TOTALS 

worksheet.set_column(0,0,29)
worksheet.set_column(1,1,10)
worksheet.set_column(2,2,10)
worksheet.set_column(3,3,10)


worksheet.set_header('CallNoCircStats')

worksheet.write(0,1,'Main', eformatlabel)
worksheet.write(0,2,'Byram', eformatlabel)
worksheet.write(0,3,'Cos Cob', eformatlabel)
worksheet.write(1,0,'000-099', eformatlabel)
worksheet.write(2,0,'100-149', eformatlabel)
worksheet.write(3,0,'150-159', eformatlabel)
worksheet.write(4,0,'160-199', eformatlabel)
worksheet.write(5,0,'200-299', eformatlabel)
worksheet.write(6,0,'300-309', eformatlabel)
worksheet.write(7,0,'320-329', eformatlabel)
worksheet.write(8,0,'330-339', eformatlabel)
worksheet.write(9,0,'340-349', eformatlabel)
worksheet.write(10,0,'350-359', eformatlabel)
worksheet.write(11,0,'360-369', eformatlabel)
worksheet.write(12,0,'370-379', eformatlabel)
worksheet.write(13,0,'380-389', eformatlabel)
worksheet.write(14,0,'390-399', eformatlabel)
worksheet.write(15,0,'400-499', eformatlabel)
worksheet.write(16,0,'500-599,310-319', eformatlabel)
worksheet.write(17,0,'600-619', eformatlabel)
worksheet.write(18,0,'620-629', eformatlabel)
worksheet.write(19,0,'630-635', eformatlabel)
worksheet.write(20,0,'636-669', eformatlabel)
worksheet.write(21,0,'640-642', eformatlabel)
worksheet.write(22,0,'643-648', eformatlabel)
worksheet.write(23,0,'649', eformatlabel)
worksheet.write(24,0,'650-659', eformatlabel)
worksheet.write(25,0,'660-699', eformatlabel)
worksheet.write(26,0,'700-709', eformatlabel)
worksheet.write(27,0,'710-719', eformatlabel)
worksheet.write(28,0,'720-769', eformatlabel)
worksheet.write(29,0,'770-779', eformatlabel)
worksheet.write(30,0,'780-789', eformatlabel)
worksheet.write(31,0,'Music Scores', eformatlabel)
worksheet.write(32,0,'790-792', eformatlabel)
worksheet.write(33,0,'793-799', eformatlabel)
worksheet.write(34,0,'800-819', eformatlabel)
worksheet.write(35,0,'820-829', eformatlabel)
worksheet.write(36,0,'830-899', eformatlabel)
worksheet.write(37,0,'900-909', eformatlabel)
worksheet.write(38,0,'910-919', eformatlabel)
worksheet.write(39,0,'920-929', eformatlabel)
worksheet.write(40,0,'930-969', eformatlabel)
worksheet.write(41,0,'970-999', eformatlabel)
worksheet.write(42,0,'Fiction', eformatlabel)
worksheet.write(43,0,'Express', eformatlabel)
worksheet.write(44,0,'Adult Graphic Novel', eformatlabel)
worksheet.write(45,0,'Mystery', eformatlabel)
worksheet.write(46,0,'Science Fiction', eformatlabel)
worksheet.write(47,0,'Short Stories', eformatlabel)
worksheet.write(48,0,'Large Print', eformatlabel)
worksheet.write(49,0,'Chinese', eformatlabel)
worksheet.write(50,0,'French', eformatlabel)
worksheet.write(51,0,'German', eformatlabel)
worksheet.write(52,0,'Italian', eformatlabel)
worksheet.write(53,0,'Japanese', eformatlabel)
worksheet.write(54,0,'Spanish', eformatlabel)
worksheet.write(55,0,'Paperback Fiction', eformatlabel)
worksheet.write(56,0,'Paperback Mystery', eformatlabel)
worksheet.write(57,0,'Paperback Romance', eformatlabel)
worksheet.write(58,0,'Paperback Non-Fiction', eformatlabel)
worksheet.write(59,0,'YA Fiction', eformatlabel)
worksheet.write(60,0,'YA Non-Fiction', eformatlabel)
worksheet.write(61,0,'YA Manga', eformatlabel)
worksheet.write(62,0,'YA Graphic Novels', eformatlabel)
worksheet.write(63,0,'YA COMP DISC Spoken Word', eformatlabel)
worksheet.write(64,0,'Adult COMP DISC Spoken Word', eformatlabel)
worksheet.write(65,0,'Downloadable Audiobook', eformatlabel)
worksheet.write(66,0,'Downloadable Music', eformatlabel)
worksheet.write(67,0,'Adult COMP DISC Music', eformatlabel)
worksheet.write(68,0,'Adult DVDs', eformatlabel)
worksheet.write(69,0,'Downloadable Video', eformatlabel)
worksheet.write(70,0,'Adult & YA Games', eformatlabel)
worksheet.write(71,0,'Interlibrary Loan', eformatlabel)
worksheet.write(72,0,'Language Learning', eformatlabel)
worksheet.write(73,0,'Local History', eformatlabel)
worksheet.write(74,0,'J 000-099', eformatlabel)
worksheet.write(75,0,'J 100-199', eformatlabel)
worksheet.write(76,0,'J 200-299', eformatlabel)
worksheet.write(77,0,'J 300-399', eformatlabel)
worksheet.write(78,0,'J 400-499', eformatlabel)
worksheet.write(79,0,'J 500-599', eformatlabel)
worksheet.write(80,0,'J 600-699', eformatlabel)
worksheet.write(81,0,'J 700-799', eformatlabel)
worksheet.write(82,0,'J 800-899', eformatlabel)
worksheet.write(83,0,'J 900-999', eformatlabel)
worksheet.write(84,0,'J Biography', eformatlabel)
worksheet.write(85,0,'J Fiction', eformatlabel)
worksheet.write(86,0,'E Books and Boardbooks', eformatlabel)
worksheet.write(87,0,'J Paperback', eformatlabel)
worksheet.write(88,0,'J COMP DISC Spoken Word', eformatlabel)
worksheet.write(89,0,'J COMP DISC Music', eformatlabel)
worksheet.write(90,0,'J Multimedia Kit', eformatlabel)
worksheet.write(91,0,'J Magazine', eformatlabel)
worksheet.write(92,0,'Reference Adult', eformatlabel)
worksheet.write(93,0,'Juvenile Reference', eformatlabel)
worksheet.write(94,0,'Oral History Transcripts', eformatlabel)
worksheet.write(95,0,'J DVDs', eformatlabel)
worksheet.write(96,0,'J Games', eformatlabel)
worksheet.write(97,0,'J Parent Corner', eformatlabel)
worksheet.write(98,0,'J German', eformatlabel)
worksheet.write(99,0,'J Italian', eformatlabel)
worksheet.write(100,0,'J Chinese', eformatlabel)
worksheet.write(101,0,'J French', eformatlabel)
worksheet.write(102,0,'J Japanese', eformatlabel)
worksheet.write(103,0,'J Spanish', eformatlabel)
worksheet.write(104,0,'J Language Learning', eformatlabel)
worksheet.write(105,0,'e Books', eformatlabel)
worksheet.write(106,0,'Adult Circulating Periodicals', eformatlabel)
worksheet.write(107,0,'Lending Art', eformatlabel)
worksheet.write(108,0,'Museum Pass', eformatlabel)
worksheet.write(109,0,'Not in table', eformatlabel)
worksheet.write(110,0,'Total', eformatlabel)

for rownum, col in enumerate(rows):
 #MAIN TOTALS   
    worksheet.write_formula('B2', "='Main'!B2+'Main'!C2")
    worksheet.write_formula('B3', "='Main'!B3+'Main'!C3")
    worksheet.write_formula('B4', "='Main'!B4+'Main'!C4")
    worksheet.write_formula('B5', "='Main'!B5+'Main'!C5")
    worksheet.write_formula('B6', "='Main'!B6+'Main'!C6")
    worksheet.write_formula('B7', "='Main'!B7+'Main'!C7")
    worksheet.write_formula('B8', "='Main'!B8+'Main'!C8")
    worksheet.write_formula('B9', "='Main'!B9+'Main'!C9")
    worksheet.write_formula('B10', "='Main'!B10+'Main'!C10")
    worksheet.write_formula('B11', "='Main'!B11+'Main'!C11")
    worksheet.write_formula('B12', "='Main'!B12+'Main'!C12")
    worksheet.write_formula('B13', "='Main'!B13+'Main'!C13")
    worksheet.write_formula('B14', "='Main'!B14+'Main'!C14")
    worksheet.write_formula('B15', "='Main'!B15+'Main'!C15")
    worksheet.write_formula('B16', "='Main'!B16+'Main'!C16")
    worksheet.write_formula('B17', "='Main'!B17+'Main'!C17")
    worksheet.write_formula('B18', "='Main'!B18+'Main'!C18")
    worksheet.write_formula('B19', "='Main'!B19+'Main'!C19")
    worksheet.write_formula('B20', "='Main'!B20+'Main'!C20")
    worksheet.write_formula('B21', "='Main'!B21+'Main'!C21")
    worksheet.write_formula('B22', "='Main'!B22+'Main'!C22")
    worksheet.write_formula('B23', "='Main'!B23+'Main'!C23")
    worksheet.write_formula('B24', "='Main'!B24+'Main'!C24")
    worksheet.write_formula('B25', "='Main'!B25+'Main'!C25")
    worksheet.write_formula('B26', "='Main'!B26+'Main'!C26")
    worksheet.write_formula('B27', "='Main'!B27+'Main'!C27")
    worksheet.write_formula('B28', "='Main'!B28+'Main'!C28")
    worksheet.write_formula('B29', "='Main'!B29+'Main'!C29")
    worksheet.write_formula('B30', "='Main'!B30+'Main'!C30")
    worksheet.write_formula('B31', "='Main'!B31+'Main'!C31")
    worksheet.write_formula('B32', "='Main'!B32+'Main'!C32")
    worksheet.write_formula('B33', "='Main'!B33+'Main'!C33")
    worksheet.write_formula('B34', "='Main'!B34+'Main'!C34")
    worksheet.write_formula('B35', "='Main'!B35+'Main'!C35")
    worksheet.write_formula('B36', "='Main'!B36+'Main'!C36")
    worksheet.write_formula('B37', "='Main'!B37+'Main'!C37")
    worksheet.write_formula('B38', "='Main'!B38+'Main'!C38")
    worksheet.write_formula('B39', "='Main'!B39+'Main'!C39")
    worksheet.write_formula('B40', "='Main'!B40+'Main'!C40")
    worksheet.write_formula('B41', "='Main'!B41+'Main'!C41")
    worksheet.write_formula('B42', "='Main'!B42+'Main'!C42")
    worksheet.write_formula('B43', "='Main'!B43+'Main'!C43")
    worksheet.write_formula('B44', "='Main'!B44+'Main'!C44")
    worksheet.write_formula('B45', "='Main'!B45+'Main'!C45")
    worksheet.write_formula('B46', "='Main'!B46+'Main'!C46")
    worksheet.write_formula('B47', "='Main'!B47+'Main'!C47")
    worksheet.write_formula('B48', "='Main'!B48+'Main'!C48")
    worksheet.write_formula('B49', "='Main'!B49+'Main'!C49")
    worksheet.write_formula('B50', "='Main'!B50+'Main'!C50")
    worksheet.write_formula('B51', "='Main'!B51+'Main'!C51")
    worksheet.write_formula('B52', "='Main'!B52+'Main'!C52")
    worksheet.write_formula('B53', "='Main'!B53+'Main'!C53")
    worksheet.write_formula('B54', "='Main'!B54+'Main'!C54")
    worksheet.write_formula('B55', "='Main'!B55+'Main'!C55")
    worksheet.write_formula('B56', "='Main'!B56+'Main'!C56")
    worksheet.write_formula('B57', "='Main'!B57+'Main'!C57")
    worksheet.write_formula('B58', "='Main'!B58+'Main'!C58")
    worksheet.write_formula('B59', "='Main'!B59+'Main'!C59")
    worksheet.write_formula('B60', "='Main'!B60+'Main'!C60")
    worksheet.write_formula('B61', "='Main'!B61+'Main'!C61")
    worksheet.write_formula('B62', "='Main'!B62+'Main'!C62")
    worksheet.write_formula('B63', "='Main'!B63+'Main'!C63")
    worksheet.write_formula('B64', "='Main'!B64+'Main'!C64")
    worksheet.write_formula('B65', "='Main'!B65+'Main'!C65")
    worksheet.write_formula('B66', "='Main'!B66+'Main'!C66")
    worksheet.write_formula('B67', "='Main'!B67+'Main'!C67")
    worksheet.write_formula('B68', "='Main'!B68+'Main'!C68")
    worksheet.write_formula('B69', "='Main'!B69+'Main'!C69")
    worksheet.write_formula('B70', "='Main'!B70+'Main'!C70")
    worksheet.write_formula('B71', "='Main'!B71+'Main'!C71")
    worksheet.write_formula('B72', "='Main'!B72+'Main'!C72")
    worksheet.write_formula('B73', "='Main'!B73+'Main'!C73")
    worksheet.write_formula('B74', "='Main'!B74+'Main'!C74")
    worksheet.write_formula('B75', "='Main'!B75+'Main'!C75")
    worksheet.write_formula('B76', "='Main'!B76+'Main'!C76")
    worksheet.write_formula('B77', "='Main'!B77+'Main'!C77")
    worksheet.write_formula('B78', "='Main'!B78+'Main'!C78")
    worksheet.write_formula('B79', "='Main'!B79+'Main'!C79")
    worksheet.write_formula('B80', "='Main'!B80+'Main'!C80")
    worksheet.write_formula('B81', "='Main'!B81+'Main'!C81")
    worksheet.write_formula('B82', "='Main'!B82+'Main'!C82")
    worksheet.write_formula('B83', "='Main'!B83+'Main'!C83")
    worksheet.write_formula('B84', "='Main'!B84+'Main'!C84")
    worksheet.write_formula('B85', "='Main'!B85+'Main'!C85")
    worksheet.write_formula('B86', "='Main'!B86+'Main'!C86")
    worksheet.write_formula('B87', "='Main'!B87+'Main'!C87")
    worksheet.write_formula('B88', "='Main'!B88+'Main'!C88")
    worksheet.write_formula('B89', "='Main'!B89+'Main'!C89")
    worksheet.write_formula('B90', "='Main'!B90+'Main'!C90")
    worksheet.write_formula('B91', "='Main'!B91+'Main'!C91")
    worksheet.write_formula('B92', "='Main'!B92+'Main'!C92")
    worksheet.write_formula('B93', "='Main'!B93+'Main'!C93")
    worksheet.write_formula('B94', "='Main'!B94+'Main'!C94")
    worksheet.write_formula('B95', "='Main'!B95+'Main'!C95")
    worksheet.write_formula('B96', "='Main'!B96+'Main'!C96")
    worksheet.write_formula('B97', "='Main'!B97+'Main'!C97")
    worksheet.write_formula('B98', "='Main'!B98+'Main'!C98")
    worksheet.write_formula('B99', "='Main'!B99+'Main'!C99")
    worksheet.write_formula('B100', "='Main'!B100+'Main'!C100")
    worksheet.write_formula('B101', "='Main'!B101+'Main'!C101")
    worksheet.write_formula('B102', "='Main'!B102+'Main'!C102")
    worksheet.write_formula('B103', "='Main'!B103+'Main'!C103")
    worksheet.write_formula('B104', "='Main'!B104+'Main'!C104")
    worksheet.write_formula('B105', "='Main'!B105+'Main'!C105")
    worksheet.write_formula('B106', "='Main'!B106+'Main'!C106")
    worksheet.write_formula('B107', "='Main'!B107+'Main'!C107")
    worksheet.write_formula('B108', "='Main'!B108+'Main'!C108")
    worksheet.write_formula('B109', "='Main'!B109+'Main'!C109")
    worksheet.write_formula('B110', "='Main'!B110+'Main'!C110")
    worksheet.write_formula('B111', "='Main'!B111+'Main'!C111")

#BYRAM TOTALS
    worksheet.write_formula('C2', "='Byram'!B2+'Byram'!C2")
    worksheet.write_formula('C3', "='Byram'!B3+'Byram'!C3")
    worksheet.write_formula('C4', "='Byram'!B4+'Byram'!C4")
    worksheet.write_formula('C5', "='Byram'!B5+'Byram'!C5")
    worksheet.write_formula('C6', "='Byram'!B6+'Byram'!C6")
    worksheet.write_formula('C7', "='Byram'!B7+'Byram'!C7")
    worksheet.write_formula('C8', "='Byram'!B8+'Byram'!C8")
    worksheet.write_formula('C9', "='Byram'!B9+'Byram'!C9")
    worksheet.write_formula('C10', "='Byram'!B10+'Byram'!C10")
    worksheet.write_formula('C11', "='Byram'!B11+'Byram'!C11")
    worksheet.write_formula('C12', "='Byram'!B12+'Byram'!C12")
    worksheet.write_formula('C13', "='Byram'!B13+'Byram'!C13")
    worksheet.write_formula('C14', "='Byram'!B14+'Byram'!C14")
    worksheet.write_formula('C15', "='Byram'!B15+'Byram'!C15")
    worksheet.write_formula('C16', "='Byram'!B16+'Byram'!C16")
    worksheet.write_formula('C17', "='Byram'!B17+'Byram'!C17")
    worksheet.write_formula('C18', "='Byram'!B18+'Byram'!C18")
    worksheet.write_formula('C19', "='Byram'!B19+'Byram'!C19")
    worksheet.write_formula('C20', "='Byram'!B20+'Byram'!C20")
    worksheet.write_formula('C21', "='Byram'!B21+'Byram'!C21")
    worksheet.write_formula('C22', "='Byram'!B22+'Byram'!C22")
    worksheet.write_formula('C23', "='Byram'!B23+'Byram'!C23")
    worksheet.write_formula('C24', "='Byram'!B24+'Byram'!C24")
    worksheet.write_formula('C25', "='Byram'!B25+'Byram'!C25")
    worksheet.write_formula('C26', "='Byram'!B26+'Byram'!C26")
    worksheet.write_formula('C27', "='Byram'!B27+'Byram'!C27")
    worksheet.write_formula('C28', "='Byram'!B28+'Byram'!C28")
    worksheet.write_formula('C29', "='Byram'!B29+'Byram'!C29")
    worksheet.write_formula('C30', "='Byram'!B30+'Byram'!C30")
    worksheet.write_formula('C31', "='Byram'!B31+'Byram'!C31")
    worksheet.write_formula('C32', "='Byram'!B32+'Byram'!C32")
    worksheet.write_formula('C33', "='Byram'!B33+'Byram'!C33")
    worksheet.write_formula('C34', "='Byram'!B34+'Byram'!C34")
    worksheet.write_formula('C35', "='Byram'!B35+'Byram'!C35")
    worksheet.write_formula('C36', "='Byram'!B36+'Byram'!C36")
    worksheet.write_formula('C37', "='Byram'!B37+'Byram'!C37")
    worksheet.write_formula('C38', "='Byram'!B38+'Byram'!C38")
    worksheet.write_formula('C39', "='Byram'!B39+'Byram'!C39")
    worksheet.write_formula('C40', "='Byram'!B40+'Byram'!C40")
    worksheet.write_formula('C41', "='Byram'!B41+'Byram'!C41")
    worksheet.write_formula('C42', "='Byram'!B42+'Byram'!C42")
    worksheet.write_formula('C43', "='Byram'!B43+'Byram'!C43")
    worksheet.write_formula('C44', "='Byram'!B44+'Byram'!C44")
    worksheet.write_formula('C45', "='Byram'!B45+'Byram'!C45")
    worksheet.write_formula('C46', "='Byram'!B46+'Byram'!C46")
    worksheet.write_formula('C47', "='Byram'!B47+'Byram'!C47")
    worksheet.write_formula('C48', "='Byram'!B48+'Byram'!C48")
    worksheet.write_formula('C49', "='Byram'!B49+'Byram'!C49")
    worksheet.write_formula('C50', "='Byram'!B50+'Byram'!C50")
    worksheet.write_formula('C51', "='Byram'!B51+'Byram'!C51")
    worksheet.write_formula('C52', "='Byram'!B52+'Byram'!C52")
    worksheet.write_formula('C53', "='Byram'!B53+'Byram'!C53")
    worksheet.write_formula('C54', "='Byram'!B54+'Byram'!C54")
    worksheet.write_formula('C55', "='Byram'!B55+'Byram'!C55")
    worksheet.write_formula('C56', "='Byram'!B56+'Byram'!C56")
    worksheet.write_formula('C57', "='Byram'!B57+'Byram'!C57")
    worksheet.write_formula('C58', "='Byram'!B58+'Byram'!C58")
    worksheet.write_formula('C59', "='Byram'!B59+'Byram'!C59")
    worksheet.write_formula('C60', "='Byram'!B60+'Byram'!C60")
    worksheet.write_formula('C61', "='Byram'!B61+'Byram'!C61")
    worksheet.write_formula('C62', "='Byram'!B62+'Byram'!C62")
    worksheet.write_formula('C63', "='Byram'!B63+'Byram'!C63")
    worksheet.write_formula('C64', "='Byram'!B64+'Byram'!C64")
    worksheet.write_formula('C65', "='Byram'!B65+'Byram'!C65")
    worksheet.write_formula('C66', "='Byram'!B66+'Byram'!C66")
    worksheet.write_formula('C67', "='Byram'!B67+'Byram'!C67")
    worksheet.write_formula('C68', "='Byram'!B68+'Byram'!C68")
    worksheet.write_formula('C69', "='Byram'!B69+'Byram'!C69")
    worksheet.write_formula('C70', "='Byram'!B70+'Byram'!C70")
    worksheet.write_formula('C71', "='Byram'!B71+'Byram'!C71")
    worksheet.write_formula('C72', "='Byram'!B72+'Byram'!C72")
    worksheet.write_formula('C73', "='Byram'!B73+'Byram'!C73")
    worksheet.write_formula('C74', "='Byram'!B74+'Byram'!C74")
    worksheet.write_formula('C75', "='Byram'!B75+'Byram'!C75")
    worksheet.write_formula('C76', "='Byram'!B76+'Byram'!C76")
    worksheet.write_formula('C77', "='Byram'!B77+'Byram'!C77")
    worksheet.write_formula('C78', "='Byram'!B78+'Byram'!C78")
    worksheet.write_formula('C79', "='Byram'!B79+'Byram'!C79")
    worksheet.write_formula('C80', "='Byram'!B80+'Byram'!C80")
    worksheet.write_formula('C81', "='Byram'!B81+'Byram'!C81")
    worksheet.write_formula('C82', "='Byram'!B82+'Byram'!C82")
    worksheet.write_formula('C83', "='Byram'!B83+'Byram'!C83")
    worksheet.write_formula('C84', "='Byram'!B84+'Byram'!C84")
    worksheet.write_formula('C85', "='Byram'!B85+'Byram'!C85")
    worksheet.write_formula('C86', "='Byram'!B86+'Byram'!C86")
    worksheet.write_formula('C87', "='Byram'!B87+'Byram'!C87")
    worksheet.write_formula('C88', "='Byram'!B88+'Byram'!C88")
    worksheet.write_formula('C89', "='Byram'!B89+'Byram'!C89")
    worksheet.write_formula('C90', "='Byram'!B90+'Byram'!C90")
    worksheet.write_formula('C91', "='Byram'!B91+'Byram'!C91")
    worksheet.write_formula('C92', "='Byram'!B92+'Byram'!C92")
    worksheet.write_formula('C93', "='Byram'!B93+'Byram'!C93")
    worksheet.write_formula('C94', "='Byram'!B94+'Byram'!C94")
    worksheet.write_formula('C95', "='Byram'!B95+'Byram'!C95")
    worksheet.write_formula('C96', "='Byram'!B96+'Byram'!C96")
    worksheet.write_formula('C97', "='Byram'!B97+'Byram'!C97")
    worksheet.write_formula('C98', "='Byram'!B98+'Byram'!C98")
    worksheet.write_formula('C99', "='Byram'!B99+'Byram'!C99")
    worksheet.write_formula('C100', "='Byram'!B100+'Byram'!C100")
    worksheet.write_formula('C101', "='Byram'!B101+'Byram'!C101")
    worksheet.write_formula('C102', "='Byram'!B102+'Byram'!C102")
    worksheet.write_formula('C103', "='Byram'!B103+'Byram'!C103")
    worksheet.write_formula('C104', "='Byram'!B104+'Byram'!C104")
    worksheet.write_formula('C105', "='Byram'!B105+'Byram'!C105")
    worksheet.write_formula('C106', "='Byram'!B106+'Byram'!C106")
    worksheet.write_formula('C107', "='Byram'!B107+'Byram'!C107")
    worksheet.write_formula('C108', "='Byram'!B108+'Byram'!C108")
    worksheet.write_formula('C109', "='Byram'!B109+'Byram'!C109")
    worksheet.write_formula('C110', "='Byram'!B110+'Byram'!C110")
    worksheet.write_formula('C111', "='Byram'!B111+'Byram'!C111")

#COS COB TOTALS    
    worksheet.write_formula('D2', "='Cos Cob'!B2+'Cos Cob'!C2")
    worksheet.write_formula('D3', "='Cos Cob'!B3+'Cos Cob'!C3")
    worksheet.write_formula('D4', "='Cos Cob'!B4+'Cos Cob'!C4")
    worksheet.write_formula('D5', "='Cos Cob'!B5+'Cos Cob'!C5")
    worksheet.write_formula('D6', "='Cos Cob'!B6+'Cos Cob'!C6")
    worksheet.write_formula('D7', "='Cos Cob'!B7+'Cos Cob'!C7")
    worksheet.write_formula('D8', "='Cos Cob'!B8+'Cos Cob'!C8")
    worksheet.write_formula('D9', "='Cos Cob'!B9+'Cos Cob'!C9")
    worksheet.write_formula('D10', "='Cos Cob'!B10+'Cos Cob'!C10")
    worksheet.write_formula('D11', "='Cos Cob'!B11+'Cos Cob'!C11")
    worksheet.write_formula('D12', "='Cos Cob'!B12+'Cos Cob'!C12")
    worksheet.write_formula('D13', "='Cos Cob'!B13+'Cos Cob'!C13")
    worksheet.write_formula('D14', "='Cos Cob'!B14+'Cos Cob'!C14")
    worksheet.write_formula('D15', "='Cos Cob'!B15+'Cos Cob'!C15")
    worksheet.write_formula('D16', "='Cos Cob'!B16+'Cos Cob'!C16")
    worksheet.write_formula('D17', "='Cos Cob'!B17+'Cos Cob'!C17")
    worksheet.write_formula('D18', "='Cos Cob'!B18+'Cos Cob'!C18")
    worksheet.write_formula('D19', "='Cos Cob'!B19+'Cos Cob'!C19")
    worksheet.write_formula('D20', "='Cos Cob'!B20+'Cos Cob'!C20")
    worksheet.write_formula('D21', "='Cos Cob'!B21+'Cos Cob'!C21")
    worksheet.write_formula('D22', "='Cos Cob'!B22+'Cos Cob'!C22")
    worksheet.write_formula('D23', "='Cos Cob'!B23+'Cos Cob'!C23")
    worksheet.write_formula('D24', "='Cos Cob'!B24+'Cos Cob'!C24")
    worksheet.write_formula('D25', "='Cos Cob'!B25+'Cos Cob'!C25")
    worksheet.write_formula('D26', "='Cos Cob'!B26+'Cos Cob'!C26")
    worksheet.write_formula('D27', "='Cos Cob'!B27+'Cos Cob'!C27")
    worksheet.write_formula('D28', "='Cos Cob'!B28+'Cos Cob'!C28")
    worksheet.write_formula('D29', "='Cos Cob'!B29+'Cos Cob'!C29")
    worksheet.write_formula('D30', "='Cos Cob'!B30+'Cos Cob'!C30")
    worksheet.write_formula('D31', "='Cos Cob'!B31+'Cos Cob'!C31")
    worksheet.write_formula('D32', "='Cos Cob'!B32+'Cos Cob'!C32")
    worksheet.write_formula('D33', "='Cos Cob'!B33+'Cos Cob'!C33")
    worksheet.write_formula('D34', "='Cos Cob'!B34+'Cos Cob'!C34")
    worksheet.write_formula('D35', "='Cos Cob'!B35+'Cos Cob'!C35")
    worksheet.write_formula('D36', "='Cos Cob'!B36+'Cos Cob'!C36")
    worksheet.write_formula('D37', "='Cos Cob'!B37+'Cos Cob'!C37")
    worksheet.write_formula('D38', "='Cos Cob'!B38+'Cos Cob'!C38")
    worksheet.write_formula('D39', "='Cos Cob'!B39+'Cos Cob'!C39")
    worksheet.write_formula('D40', "='Cos Cob'!B40+'Cos Cob'!C40")
    worksheet.write_formula('D41', "='Cos Cob'!B41+'Cos Cob'!C41")
    worksheet.write_formula('D42', "='Cos Cob'!B42+'Cos Cob'!C42")
    worksheet.write_formula('D43', "='Cos Cob'!B43+'Cos Cob'!C43")
    worksheet.write_formula('D44', "='Cos Cob'!B44+'Cos Cob'!C44")
    worksheet.write_formula('D45', "='Cos Cob'!B45+'Cos Cob'!C45")
    worksheet.write_formula('D46', "='Cos Cob'!B46+'Cos Cob'!C46")
    worksheet.write_formula('D47', "='Cos Cob'!B47+'Cos Cob'!C47")
    worksheet.write_formula('D48', "='Cos Cob'!B48+'Cos Cob'!C48")
    worksheet.write_formula('D49', "='Cos Cob'!B49+'Cos Cob'!C49")
    worksheet.write_formula('D50', "='Cos Cob'!B50+'Cos Cob'!C50")
    worksheet.write_formula('D51', "='Cos Cob'!B51+'Cos Cob'!C51")
    worksheet.write_formula('D52', "='Cos Cob'!B52+'Cos Cob'!C52")
    worksheet.write_formula('D53', "='Cos Cob'!B53+'Cos Cob'!C53")
    worksheet.write_formula('D54', "='Cos Cob'!B54+'Cos Cob'!C54")
    worksheet.write_formula('D55', "='Cos Cob'!B55+'Cos Cob'!C55")
    worksheet.write_formula('D56', "='Cos Cob'!B56+'Cos Cob'!C56")
    worksheet.write_formula('D57', "='Cos Cob'!B57+'Cos Cob'!C57")
    worksheet.write_formula('D58', "='Cos Cob'!B58+'Cos Cob'!C58")
    worksheet.write_formula('D59', "='Cos Cob'!B59+'Cos Cob'!C59")
    worksheet.write_formula('D60', "='Cos Cob'!B60+'Cos Cob'!C60")
    worksheet.write_formula('D61', "='Cos Cob'!B61+'Cos Cob'!C61")
    worksheet.write_formula('D62', "='Cos Cob'!B62+'Cos Cob'!C62")
    worksheet.write_formula('D63', "='Cos Cob'!B63+'Cos Cob'!C63")
    worksheet.write_formula('D64', "='Cos Cob'!B64+'Cos Cob'!C64")
    worksheet.write_formula('D65', "='Cos Cob'!B65+'Cos Cob'!C65")
    worksheet.write_formula('D66', "='Cos Cob'!B66+'Cos Cob'!C66")
    worksheet.write_formula('D67', "='Cos Cob'!B67+'Cos Cob'!C67")
    worksheet.write_formula('D68', "='Cos Cob'!B68+'Cos Cob'!C68")
    worksheet.write_formula('D69', "='Cos Cob'!B69+'Cos Cob'!C69")
    worksheet.write_formula('D70', "='Cos Cob'!B70+'Cos Cob'!C70")
    worksheet.write_formula('D71', "='Cos Cob'!B71+'Cos Cob'!C71")
    worksheet.write_formula('D72', "='Cos Cob'!B72+'Cos Cob'!C72")
    worksheet.write_formula('D73', "='Cos Cob'!B73+'Cos Cob'!C73")
    worksheet.write_formula('D74', "='Cos Cob'!B74+'Cos Cob'!C74")
    worksheet.write_formula('D75', "='Cos Cob'!B75+'Cos Cob'!C75")
    worksheet.write_formula('D76', "='Cos Cob'!B76+'Cos Cob'!C76")
    worksheet.write_formula('D77', "='Cos Cob'!B77+'Cos Cob'!C77")
    worksheet.write_formula('D78', "='Cos Cob'!B78+'Cos Cob'!C78")
    worksheet.write_formula('D79', "='Cos Cob'!B79+'Cos Cob'!C79")
    worksheet.write_formula('D80', "='Cos Cob'!B80+'Cos Cob'!C80")
    worksheet.write_formula('D81', "='Cos Cob'!B81+'Cos Cob'!C81")
    worksheet.write_formula('D82', "='Cos Cob'!B82+'Cos Cob'!C82")
    worksheet.write_formula('D83', "='Cos Cob'!B83+'Cos Cob'!C83")
    worksheet.write_formula('D84', "='Cos Cob'!B84+'Cos Cob'!C84")
    worksheet.write_formula('D85', "='Cos Cob'!B85+'Cos Cob'!C85")
    worksheet.write_formula('D86', "='Cos Cob'!B86+'Cos Cob'!C86")
    worksheet.write_formula('D87', "='Cos Cob'!B87+'Cos Cob'!C87")
    worksheet.write_formula('D88', "='Cos Cob'!B88+'Cos Cob'!C88")
    worksheet.write_formula('D89', "='Cos Cob'!B89+'Cos Cob'!C89")
    worksheet.write_formula('D90', "='Cos Cob'!B90+'Cos Cob'!C90")
    worksheet.write_formula('D91', "='Cos Cob'!B91+'Cos Cob'!C91")
    worksheet.write_formula('D92', "='Cos Cob'!B92+'Cos Cob'!C92")
    worksheet.write_formula('D93', "='Cos Cob'!B93+'Cos Cob'!C93")
    worksheet.write_formula('D94', "='Cos Cob'!B94+'Cos Cob'!C94")
    worksheet.write_formula('D95', "='Cos Cob'!B95+'Cos Cob'!C95")
    worksheet.write_formula('D96', "='Cos Cob'!B96+'Cos Cob'!C96")
    worksheet.write_formula('D97', "='Cos Cob'!B97+'Cos Cob'!C97")
    worksheet.write_formula('D98', "='Cos Cob'!B98+'Cos Cob'!C98")
    worksheet.write_formula('D99', "='Cos Cob'!B99+'Cos Cob'!C99")
    worksheet.write_formula('D100', "='Cos Cob'!B100+'Cos Cob'!C100")
    worksheet.write_formula('D101', "='Cos Cob'!B101+'Cos Cob'!C101")
    worksheet.write_formula('D102', "='Cos Cob'!B102+'Cos Cob'!C102")
    worksheet.write_formula('D103', "='Cos Cob'!B103+'Cos Cob'!C103")
    worksheet.write_formula('D104', "='Cos Cob'!B104+'Cos Cob'!C104")
    worksheet.write_formula('D105', "='Cos Cob'!B105+'Cos Cob'!C105")
    worksheet.write_formula('D106', "='Cos Cob'!B106+'Cos Cob'!C106")
    worksheet.write_formula('D107', "='Cos Cob'!B107+'Cos Cob'!C107")
    worksheet.write_formula('D108', "='Cos Cob'!B108+'Cos Cob'!C108")
    worksheet.write_formula('D109', "='Cos Cob'!B109+'Cos Cob'!C109")
    worksheet.write_formula('D110', "='Cos Cob'!B110+'Cos Cob'!C110")
    worksheet.write_formula('D111', "='Cos Cob'!B111+'Cos Cob'!C111")

worksheet = workbook.add_worksheet('Main')


worksheet.set_landscape()
worksheet.hide_gridlines(0)



eformat= workbook.add_format({'text_wrap': True, 'valign': 'top' , 'num_format': 'mm/dd/yy'})
eformatlabel= workbook.add_format({'text_wrap': False, 'valign': 'top', 'bold': True})



worksheet.set_column(0,0,29)
worksheet.set_column(1,1,10)
worksheet.set_column(2,2,10)





worksheet.write(0,1,'Checkouts', eformatlabel)
worksheet.write(0,2,'Renewals', eformatlabel)
worksheet.write(1,0,'000-099', eformatlabel)
worksheet.write(2,0,'100-149', eformatlabel)
worksheet.write(3,0,'150-159', eformatlabel)
worksheet.write(4,0,'160-199', eformatlabel)
worksheet.write(5,0,'200-299', eformatlabel)
worksheet.write(6,0,'300-309', eformatlabel)
worksheet.write(7,0,'320-329', eformatlabel)
worksheet.write(8,0,'330-339', eformatlabel)
worksheet.write(9,0,'340-349', eformatlabel)
worksheet.write(10,0,'350-359', eformatlabel)
worksheet.write(11,0,'360-369', eformatlabel)
worksheet.write(12,0,'370-379', eformatlabel)
worksheet.write(13,0,'380-389', eformatlabel)
worksheet.write(14,0,'390-399', eformatlabel)
worksheet.write(15,0,'400-499', eformatlabel)
worksheet.write(16,0,'500-599,310-319', eformatlabel)
worksheet.write(17,0,'600-619', eformatlabel)
worksheet.write(18,0,'620-629', eformatlabel)
worksheet.write(19,0,'630-635', eformatlabel)
worksheet.write(20,0,'636-669', eformatlabel)
worksheet.write(21,0,'640-642', eformatlabel)
worksheet.write(22,0,'643-648', eformatlabel)
worksheet.write(23,0,'649', eformatlabel)
worksheet.write(24,0,'650-659', eformatlabel)
worksheet.write(25,0,'660-699', eformatlabel)
worksheet.write(26,0,'700-709', eformatlabel)
worksheet.write(27,0,'710-719', eformatlabel)
worksheet.write(28,0,'720-769', eformatlabel)
worksheet.write(29,0,'770-779', eformatlabel)
worksheet.write(30,0,'780-789', eformatlabel)
worksheet.write(31,0,'Music Scores', eformatlabel)
worksheet.write(32,0,'790-792', eformatlabel)
worksheet.write(33,0,'793-799', eformatlabel)
worksheet.write(34,0,'800-819', eformatlabel)
worksheet.write(35,0,'820-829', eformatlabel)
worksheet.write(36,0,'830-899', eformatlabel)
worksheet.write(37,0,'900-909', eformatlabel)
worksheet.write(38,0,'910-919', eformatlabel)
worksheet.write(39,0,'920-929', eformatlabel)
worksheet.write(40,0,'930-969', eformatlabel)
worksheet.write(41,0,'970-999', eformatlabel)
worksheet.write(42,0,'Fiction', eformatlabel)
worksheet.write(43,0,'Express', eformatlabel)
worksheet.write(44,0,'Adult Graphic Novel', eformatlabel)
worksheet.write(45,0,'Mystery', eformatlabel)
worksheet.write(46,0,'Science Fiction', eformatlabel)
worksheet.write(47,0,'Short Stories', eformatlabel)
worksheet.write(48,0,'Large Print', eformatlabel)
worksheet.write(49,0,'Chinese', eformatlabel)
worksheet.write(50,0,'French', eformatlabel)
worksheet.write(51,0,'German', eformatlabel)
worksheet.write(52,0,'Italian', eformatlabel)
worksheet.write(53,0,'Japanese', eformatlabel)
worksheet.write(54,0,'Spanish', eformatlabel)
worksheet.write(55,0,'Paperback Fiction', eformatlabel)
worksheet.write(56,0,'Paperback Mystery', eformatlabel)
worksheet.write(57,0,'Paperback Romance', eformatlabel)
worksheet.write(58,0,'Paperback Non-Fiction', eformatlabel)
worksheet.write(59,0,'YA Fiction', eformatlabel)
worksheet.write(60,0,'YA Non-Fiction', eformatlabel)
worksheet.write(61,0,'YA Manga', eformatlabel)
worksheet.write(62,0,'YA Graphic Novels', eformatlabel)
worksheet.write(63,0,'YA COMP DISC Spoken Word', eformatlabel)
worksheet.write(64,0,'Adult COMP DISC Spoken Word', eformatlabel)
worksheet.write(65,0,'Downloadable Audiobook', eformatlabel)
worksheet.write(66,0,'Downloadable Music', eformatlabel)
worksheet.write(67,0,'Adult COMP DISC Music', eformatlabel)
worksheet.write(68,0,'Adult DVDs', eformatlabel)
worksheet.write(69,0,'Downloadable Video', eformatlabel)
worksheet.write(70,0,'Adult & YA Games', eformatlabel)
worksheet.write(71,0,'Interlibrary Loan', eformatlabel)
worksheet.write(72,0,'Language Learning', eformatlabel)
worksheet.write(73,0,'Local History', eformatlabel)
worksheet.write(74,0,'J 000-099', eformatlabel)
worksheet.write(75,0,'J 100-199', eformatlabel)
worksheet.write(76,0,'J 200-299', eformatlabel)
worksheet.write(77,0,'J 300-399', eformatlabel)
worksheet.write(78,0,'J 400-499', eformatlabel)
worksheet.write(79,0,'J 500-599', eformatlabel)
worksheet.write(80,0,'J 600-699', eformatlabel)
worksheet.write(81,0,'J 700-799', eformatlabel)
worksheet.write(82,0,'J 800-899', eformatlabel)
worksheet.write(83,0,'J 900-999', eformatlabel)
worksheet.write(84,0,'J Biography', eformatlabel)
worksheet.write(85,0,'J Fiction', eformatlabel)
worksheet.write(86,0,'E Books and Boardbooks', eformatlabel)
worksheet.write(87,0,'J Paperback', eformatlabel)
worksheet.write(88,0,'J COMP DISC Spoken Word', eformatlabel)
worksheet.write(89,0,'J COMP DISC Music', eformatlabel)
worksheet.write(90,0,'J Multimedia Kit', eformatlabel)
worksheet.write(91,0,'J Magazine', eformatlabel)
worksheet.write(92,0,'Reference Adult', eformatlabel)
worksheet.write(93,0,'Juvenile Reference', eformatlabel)
worksheet.write(94,0,'Oral History Transcripts', eformatlabel)
worksheet.write(95,0,'J DVDs', eformatlabel)
worksheet.write(96,0,'J Games', eformatlabel)
worksheet.write(97,0,'J Parent Corner', eformatlabel)
worksheet.write(98,0,'J German', eformatlabel)
worksheet.write(99,0,'J Italian', eformatlabel)
worksheet.write(100,0,'J Chinese', eformatlabel)
worksheet.write(101,0,'J French', eformatlabel)
worksheet.write(102,0,'J Japanese', eformatlabel)
worksheet.write(103,0,'J Spanish', eformatlabel)
worksheet.write(104,0,'J Language Learning', eformatlabel)
worksheet.write(105,0,'e Books', eformatlabel)
worksheet.write(106,0,'Adult Circulating Periodicals', eformatlabel)
worksheet.write(107,0,'Lending Art', eformatlabel)
worksheet.write(108,0,'Museum Pass', eformatlabel)
worksheet.write(109,0,'Not in table', eformatlabel)
worksheet.write(110,0,'Total', eformatlabel)



for rownum, col in enumerate(rows):
 #MAIN Checkout numbers
    worksheet.write(rownum+1,1,col[0])
    worksheet.write(rownum+2,1,col[1])
    worksheet.write(rownum+3,1,col[2])
    worksheet.write(rownum+4,1,col[3])
    worksheet.write(rownum+5,1,col[4])
    worksheet.write(rownum+6,1,col[5])
    worksheet.write(rownum+7,1,col[6])
    worksheet.write(rownum+8,1,col[7])
    worksheet.write(rownum+9,1,col[8]) 
    worksheet.write(rownum+10,1,col[9]) 
    worksheet.write(rownum+11,1,col[10])
    worksheet.write(rownum+12,1,col[11]) 
    worksheet.write(rownum+13,1,col[12])     
    worksheet.write(rownum+14,1,col[13])    
    worksheet.write(rownum+15,1,col[14])
    worksheet.write(rownum+16,1,col[15])
    worksheet.write(rownum+17,1,col[16])
    worksheet.write(rownum+18,1,col[17])
    worksheet.write(rownum+19,1,col[18]) 
    worksheet.write(rownum+20,1,col[19]) 
    worksheet.write(rownum+21,1,col[20])
    worksheet.write(rownum+22,1,col[21])
    worksheet.write(rownum+23,1,col[22])
    worksheet.write(rownum+24,1,col[23])
    worksheet.write(rownum+25,1,col[24])
    worksheet.write(rownum+26,1,col[25])
    worksheet.write(rownum+27,1,col[26])
    worksheet.write(rownum+28,1,col[27])
    worksheet.write(rownum+29,1,col[28]) 
    worksheet.write(rownum+30,1,col[29]) 
    worksheet.write(rownum+31,1,col[30])
    worksheet.write(rownum+32,1,col[31])
    worksheet.write(rownum+33,1,col[32])
    worksheet.write(rownum+34,1,col[33])
    worksheet.write(rownum+35,1,col[34])
    worksheet.write(rownum+36,1,col[35])
    worksheet.write(rownum+37,1,col[36])
    worksheet.write(rownum+38,1,col[37])
    worksheet.write(rownum+39,1,col[38]) 
    worksheet.write(rownum+40,1,col[39])
    worksheet.write(rownum+41,1,col[40])
    worksheet.write(rownum+42,1,col[41])
    worksheet.write(rownum+43,1,col[42])
    worksheet.write(rownum+44,1,col[43])
    worksheet.write(rownum+45,1,col[44])
    worksheet.write(rownum+46,1,col[45])
    worksheet.write(rownum+47,1,col[46])
    worksheet.write(rownum+48,1,col[47])
    worksheet.write(rownum+49,1,col[48]) 
    worksheet.write(rownum+50,1,col[49])
    worksheet.write(rownum+51,1,col[50])
    worksheet.write(rownum+52,1,col[51])
    worksheet.write(rownum+53,1,col[52])
    worksheet.write(rownum+54,1,col[53])
    worksheet.write(rownum+55,1,col[54])
    worksheet.write(rownum+56,1,col[55])
    worksheet.write(rownum+57,1,col[56])
    worksheet.write(rownum+58,1,col[57])
    worksheet.write(rownum+59,1,col[58]) 
    worksheet.write(rownum+60,1,col[59])
    worksheet.write(rownum+61,1,col[60])
    worksheet.write(rownum+62,1,col[61])
    worksheet.write(rownum+63,1,col[62])
    worksheet.write(rownum+64,1,col[63])
    worksheet.write(rownum+65,1,col[64])
    worksheet.write(rownum+66,1,col[65])
    worksheet.write(rownum+67,1,col[66])
    worksheet.write(rownum+68,1,col[67])
    worksheet.write(rownum+69,1,col[68]) 
    worksheet.write(rownum+70,1,col[69]) 
    worksheet.write(rownum+71,1,col[70])
    worksheet.write(rownum+72,1,col[71])
    worksheet.write(rownum+73,1,col[72])
    worksheet.write(rownum+74,1,col[73])
    worksheet.write(rownum+75,1,col[74])
    worksheet.write(rownum+76,1,col[75])
    worksheet.write(rownum+77,1,col[76])
    worksheet.write(rownum+78,1,col[77])
    worksheet.write(rownum+79,1,col[78]) 
    worksheet.write(rownum+80,1,col[79]) 
    worksheet.write(rownum+81,1,col[80])
    worksheet.write(rownum+82,1,col[81])
    worksheet.write(rownum+83,1,col[82])
    worksheet.write(rownum+84,1,col[83])
    worksheet.write(rownum+85,1,col[84])
    worksheet.write(rownum+86,1,col[85])
    worksheet.write(rownum+87,1,col[86])
    worksheet.write(rownum+88,1,col[87])
    worksheet.write(rownum+89,1,col[88]) 
    worksheet.write(rownum+90,1,col[89]) 
    worksheet.write(rownum+91,1,col[90])
    worksheet.write(rownum+92,1,col[91])
    worksheet.write(rownum+93,1,col[92])
    worksheet.write(rownum+94,1,col[93])
    worksheet.write(rownum+95,1,col[94])
    worksheet.write(rownum+96,1,col[95])
    worksheet.write(rownum+97,1,col[96])
    worksheet.write(rownum+98,1,col[97])
    worksheet.write(rownum+99,1,col[98]) 
    worksheet.write(rownum+100,1,col[99]) 
    worksheet.write(rownum+101,1,col[100])
    worksheet.write(rownum+102,1,col[101])
    worksheet.write(rownum+103,1,col[102])
    worksheet.write(rownum+104,1,col[103])
    worksheet.write(rownum+105,1,col[104])
    worksheet.write(rownum+106,1,col[105])
    worksheet.write(rownum+107,1,col[106])
    worksheet.write(rownum+108,1,col[107])
    worksheet.write_formula('B110', '=B111-Sum(B2:B109)')
    worksheet.write(rownum+110,1,col[108])
#MAIN Renewal numbers    
    worksheet.write(rownum+1,2,col[109])
    worksheet.write(rownum+2,2,col[110])
    worksheet.write(rownum+3,2,col[111])
    worksheet.write(rownum+4,2,col[112])
    worksheet.write(rownum+5,2,col[113])
    worksheet.write(rownum+6,2,col[114])
    worksheet.write(rownum+7,2,col[115])
    worksheet.write(rownum+8,2,col[116])
    worksheet.write(rownum+9,2,col[117]) 
    worksheet.write(rownum+10,2,col[118]) 
    worksheet.write(rownum+11,2,col[119])
    worksheet.write(rownum+12,2,col[120]) 
    worksheet.write(rownum+13,2,col[121])     
    worksheet.write(rownum+14,2,col[122])
    worksheet.write(rownum+15,2,col[123])    
    worksheet.write(rownum+16,2,col[124])
    worksheet.write(rownum+17,2,col[125])
    worksheet.write(rownum+18,2,col[126])
    worksheet.write(rownum+19,2,col[127])
    worksheet.write(rownum+20,2,col[128]) 
    worksheet.write(rownum+21,2,col[129]) 
    worksheet.write(rownum+22,2,col[130])
    worksheet.write(rownum+23,2,col[131])
    worksheet.write(rownum+24,2,col[132])
    worksheet.write(rownum+25,2,col[133])
    worksheet.write(rownum+26,2,col[134])
    worksheet.write(rownum+27,2,col[135])
    worksheet.write(rownum+28,2,col[136])
    worksheet.write(rownum+29,2,col[137]) 
    worksheet.write(rownum+30,2,col[138]) 
    worksheet.write(rownum+31,2,col[139])
    worksheet.write(rownum+32,2,col[140])
    worksheet.write(rownum+33,2,col[141])
    worksheet.write(rownum+34,2,col[142])
    worksheet.write(rownum+35,2,col[143])
    worksheet.write(rownum+36,2,col[144])
    worksheet.write(rownum+37,2,col[145])
    worksheet.write(rownum+38,2,col[146])
    worksheet.write(rownum+39,2,col[147]) 
    worksheet.write(rownum+40,2,col[148])
    worksheet.write(rownum+41,2,col[149])
    worksheet.write(rownum+42,2,col[150])
    worksheet.write(rownum+43,2,col[151])
    worksheet.write(rownum+44,2,col[152])
    worksheet.write(rownum+45,2,col[153])
    worksheet.write(rownum+46,2,col[154])
    worksheet.write(rownum+47,2,col[155])
    worksheet.write(rownum+48,2,col[156])
    worksheet.write(rownum+49,2,col[157]) 
    worksheet.write(rownum+50,2,col[158])
    worksheet.write(rownum+51,2,col[159])
    worksheet.write(rownum+52,2,col[160])
    worksheet.write(rownum+53,2,col[161])
    worksheet.write(rownum+54,2,col[162])
    worksheet.write(rownum+55,2,col[163])
    worksheet.write(rownum+56,2,col[164])
    worksheet.write(rownum+57,2,col[165])
    worksheet.write(rownum+58,2,col[166])
    worksheet.write(rownum+59,2,col[167]) 
    worksheet.write(rownum+60,2,col[168])
    worksheet.write(rownum+61,2,col[169])
    worksheet.write(rownum+62,2,col[170])
    worksheet.write(rownum+63,2,col[171])
    worksheet.write(rownum+64,2,col[172])
    worksheet.write(rownum+65,2,col[173])
    worksheet.write(rownum+66,2,col[174])
    worksheet.write(rownum+67,2,col[175])
    worksheet.write(rownum+68,2,col[176])
    worksheet.write(rownum+69,2,col[177]) 
    worksheet.write(rownum+70,2,col[178]) 
    worksheet.write(rownum+71,2,col[179])
    worksheet.write(rownum+72,2,col[180])
    worksheet.write(rownum+73,2,col[181])
    worksheet.write(rownum+74,2,col[182])
    worksheet.write(rownum+75,2,col[183])
    worksheet.write(rownum+76,2,col[184])
    worksheet.write(rownum+77,2,col[185])
    worksheet.write(rownum+78,2,col[186])
    worksheet.write(rownum+79,2,col[187]) 
    worksheet.write(rownum+80,2,col[188]) 
    worksheet.write(rownum+81,2,col[189])
    worksheet.write(rownum+82,2,col[190])
    worksheet.write(rownum+83,2,col[191])
    worksheet.write(rownum+84,2,col[192])
    worksheet.write(rownum+85,2,col[193])
    worksheet.write(rownum+86,2,col[194])
    worksheet.write(rownum+87,2,col[195])
    worksheet.write(rownum+88,2,col[196])
    worksheet.write(rownum+89,2,col[197]) 
    worksheet.write(rownum+90,2,col[198]) 
    worksheet.write(rownum+91,2,col[199])
    worksheet.write(rownum+92,2,col[200])
    worksheet.write(rownum+93,2,col[201])
    worksheet.write(rownum+94,2,col[202])
    worksheet.write(rownum+95,2,col[203])
    worksheet.write(rownum+96,2,col[204])
    worksheet.write(rownum+97,2,col[205])
    worksheet.write(rownum+98,2,col[206])
    worksheet.write(rownum+99,2,col[207]) 
    worksheet.write(rownum+100,2,col[208]) 
    worksheet.write(rownum+101,2,col[209])
    worksheet.write(rownum+102,2,col[210])
    worksheet.write(rownum+103,2,col[211])
    worksheet.write(rownum+104,2,col[212])
    worksheet.write(rownum+105,2,col[213])
    worksheet.write(rownum+106,2,col[214])
    worksheet.write(rownum+107,2,col[215])
    worksheet.write(rownum+108,2,col[216])
    worksheet.write_formula('C110', '=C111-Sum(C2:C109)')
    worksheet.write(rownum+110,2,col[217])
    



worksheet = workbook.add_worksheet('Byram')



eformat= workbook.add_format({'text_wrap': True, 'valign': 'top' , 'num_format': 'mm/dd/yy'})
eformatlabel= workbook.add_format({'text_wrap': False, 'valign': 'top', 'bold': True})
    
worksheet.set_header('Byram')

worksheet.set_column(0,0,29)
worksheet.set_column(1,1,10)
worksheet.set_column(2,2,10)



worksheet.write(0,1,'Checkouts', eformatlabel)
worksheet.write(0,2,'Renewals', eformatlabel)
worksheet.write(1,0,'000-099', eformatlabel)
worksheet.write(2,0,'100-149', eformatlabel)
worksheet.write(3,0,'150-159', eformatlabel)
worksheet.write(4,0,'160-199', eformatlabel)
worksheet.write(5,0,'200-299', eformatlabel)
worksheet.write(6,0,'300-309', eformatlabel)
worksheet.write(7,0,'320-329', eformatlabel)
worksheet.write(8,0,'330-339', eformatlabel)
worksheet.write(9,0,'340-349', eformatlabel)
worksheet.write(10,0,'350-359', eformatlabel)
worksheet.write(11,0,'360-369', eformatlabel)
worksheet.write(12,0,'370-379', eformatlabel)
worksheet.write(13,0,'380-389', eformatlabel)
worksheet.write(14,0,'390-399', eformatlabel)
worksheet.write(15,0,'400-499', eformatlabel)
worksheet.write(16,0,'500-599,310-319', eformatlabel)
worksheet.write(17,0,'600-619', eformatlabel)
worksheet.write(18,0,'620-629', eformatlabel)
worksheet.write(19,0,'630-635', eformatlabel)
worksheet.write(20,0,'636-669', eformatlabel)
worksheet.write(21,0,'640-642', eformatlabel)
worksheet.write(22,0,'643-648', eformatlabel)
worksheet.write(23,0,'649', eformatlabel)
worksheet.write(24,0,'650-659', eformatlabel)
worksheet.write(25,0,'660-699', eformatlabel)
worksheet.write(26,0,'700-709', eformatlabel)
worksheet.write(27,0,'710-719', eformatlabel)
worksheet.write(28,0,'720-769', eformatlabel)
worksheet.write(29,0,'770-779', eformatlabel)
worksheet.write(30,0,'780-789', eformatlabel)
worksheet.write(31,0,'Music Scores', eformatlabel)
worksheet.write(32,0,'790-792', eformatlabel)
worksheet.write(33,0,'793-799', eformatlabel)
worksheet.write(34,0,'800-819', eformatlabel)
worksheet.write(35,0,'820-829', eformatlabel)
worksheet.write(36,0,'830-899', eformatlabel)
worksheet.write(37,0,'900-909', eformatlabel)
worksheet.write(38,0,'910-919', eformatlabel)
worksheet.write(39,0,'920-929', eformatlabel)
worksheet.write(40,0,'930-969', eformatlabel)
worksheet.write(41,0,'970-999', eformatlabel)
worksheet.write(42,0,'Fiction', eformatlabel)
worksheet.write(43,0,'Express', eformatlabel)
worksheet.write(44,0,'Adult Graphic Novel', eformatlabel)
worksheet.write(45,0,'Mystery', eformatlabel)
worksheet.write(46,0,'Science Fiction', eformatlabel)
worksheet.write(47,0,'Short Stories', eformatlabel)
worksheet.write(48,0,'Large Print', eformatlabel)
worksheet.write(49,0,'Chinese', eformatlabel)
worksheet.write(50,0,'French', eformatlabel)
worksheet.write(51,0,'German', eformatlabel)
worksheet.write(52,0,'Italian', eformatlabel)
worksheet.write(53,0,'Japanese', eformatlabel)
worksheet.write(54,0,'Spanish', eformatlabel)
worksheet.write(55,0,'Paperback Fiction', eformatlabel)
worksheet.write(56,0,'Paperback Mystery', eformatlabel)
worksheet.write(57,0,'Paperback Romance', eformatlabel)
worksheet.write(58,0,'Paperback Non-Fiction', eformatlabel)
worksheet.write(59,0,'YA Fiction', eformatlabel)
worksheet.write(60,0,'YA Non-Fiction', eformatlabel)
worksheet.write(61,0,'YA Manga', eformatlabel)
worksheet.write(62,0,'YA Graphic Novels', eformatlabel)
worksheet.write(63,0,'YA COMP DISC Spoken Word', eformatlabel)
worksheet.write(64,0,'Adult COMP DISC Spoken Word', eformatlabel)
worksheet.write(65,0,'Downloadable Audiobook', eformatlabel)
worksheet.write(66,0,'Downloadable Music', eformatlabel)
worksheet.write(67,0,'Adult COMP DISC Music', eformatlabel)
worksheet.write(68,0,'Adult DVDs', eformatlabel)
worksheet.write(69,0,'Downloadable Video', eformatlabel)
worksheet.write(70,0,'Adult & YA Games', eformatlabel)
worksheet.write(71,0,'Interlibrary Loan', eformatlabel)
worksheet.write(72,0,'Language Learning', eformatlabel)
worksheet.write(73,0,'Local History', eformatlabel)
worksheet.write(74,0,'J 000-099', eformatlabel)
worksheet.write(75,0,'J 100-199', eformatlabel)
worksheet.write(76,0,'J 200-299', eformatlabel)
worksheet.write(77,0,'J 300-399', eformatlabel)
worksheet.write(78,0,'J 400-499', eformatlabel)
worksheet.write(79,0,'J 500-599', eformatlabel)
worksheet.write(80,0,'J 600-699', eformatlabel)
worksheet.write(81,0,'J 700-799', eformatlabel)
worksheet.write(82,0,'J 800-899', eformatlabel)
worksheet.write(83,0,'J 900-999', eformatlabel)
worksheet.write(84,0,'J Biography', eformatlabel)
worksheet.write(85,0,'J Fiction', eformatlabel)
worksheet.write(86,0,'E Books and Boardbooks', eformatlabel)
worksheet.write(87,0,'J Paperback', eformatlabel)
worksheet.write(88,0,'J COMP DISC Spoken Word', eformatlabel)
worksheet.write(89,0,'J COMP DISC Music', eformatlabel)
worksheet.write(90,0,'J Multimedia Kit', eformatlabel)
worksheet.write(91,0,'J Magazine', eformatlabel)
worksheet.write(92,0,'Reference Adult', eformatlabel)
worksheet.write(93,0,'Juvenile Reference', eformatlabel)
worksheet.write(94,0,'Oral History Transcripts', eformatlabel)
worksheet.write(95,0,'J DVDs', eformatlabel)
worksheet.write(96,0,'J Games', eformatlabel)
worksheet.write(97,0,'J Parent Corner', eformatlabel)
worksheet.write(98,0,'J German', eformatlabel)
worksheet.write(99,0,'J Italian', eformatlabel)
worksheet.write(100,0,'J Chinese', eformatlabel)
worksheet.write(101,0,'J French', eformatlabel)
worksheet.write(102,0,'J Japanese', eformatlabel)
worksheet.write(103,0,'J Spanish', eformatlabel)
worksheet.write(104,0,'J Language Learning', eformatlabel)
worksheet.write(105,0,'e Books', eformatlabel)
worksheet.write(106,0,'Adult Circulating Periodicals', eformatlabel)
worksheet.write(107,0,'Lending Art', eformatlabel)
worksheet.write(108,0,'Museum Pass', eformatlabel)
worksheet.write(109,0,'Not in table', eformatlabel)
worksheet.write(110,0,'Total', eformatlabel)



for rownum, col in enumerate(rows):
 #BYR Checkout numbers
    worksheet.write(rownum+1,1,col[218])
    worksheet.write(rownum+2,1,col[219])
    worksheet.write(rownum+3,1,col[220])
    worksheet.write(rownum+4,1,col[221])
    worksheet.write(rownum+5,1,col[222])
    worksheet.write(rownum+6,1,col[223])
    worksheet.write(rownum+7,1,col[224])
    worksheet.write(rownum+8,1,col[225])
    worksheet.write(rownum+9,1,col[226]) 
    worksheet.write(rownum+10,1,col[227]) 
    worksheet.write(rownum+11,1,col[228])
    worksheet.write(rownum+12,1,col[229]) 
    worksheet.write(rownum+13,1,col[230])     
    worksheet.write(rownum+14,1,col[231])    
    worksheet.write(rownum+15,1,col[232])
    worksheet.write(rownum+16,1,col[233])
    worksheet.write(rownum+17,1,col[234])
    worksheet.write(rownum+18,1,col[235])
    worksheet.write(rownum+19,1,col[236]) 
    worksheet.write(rownum+20,1,col[237]) 
    worksheet.write(rownum+21,1,col[238])
    worksheet.write(rownum+22,1,col[239])
    worksheet.write(rownum+23,1,col[240])
    worksheet.write(rownum+24,1,col[241])
    worksheet.write(rownum+25,1,col[242])
    worksheet.write(rownum+26,1,col[243])
    worksheet.write(rownum+27,1,col[244])
    worksheet.write(rownum+28,1,col[245])
    worksheet.write(rownum+29,1,col[246]) 
    worksheet.write(rownum+30,1,col[247]) 
    worksheet.write(rownum+31,1,col[248])
    worksheet.write(rownum+32,1,col[249])
    worksheet.write(rownum+33,1,col[250])
    worksheet.write(rownum+34,1,col[251])
    worksheet.write(rownum+35,1,col[252])
    worksheet.write(rownum+36,1,col[253])
    worksheet.write(rownum+37,1,col[254])
    worksheet.write(rownum+38,1,col[255])
    worksheet.write(rownum+39,1,col[256]) 
    worksheet.write(rownum+40,1,col[257])
    worksheet.write(rownum+41,1,col[258])
    worksheet.write(rownum+42,1,col[259])
    worksheet.write(rownum+43,1,col[260])
    worksheet.write(rownum+44,1,col[261])
    worksheet.write(rownum+45,1,col[262])
    worksheet.write(rownum+46,1,col[263])
    worksheet.write(rownum+47,1,col[264])
    worksheet.write(rownum+48,1,col[265])
    worksheet.write(rownum+49,1,col[266]) 
    worksheet.write(rownum+50,1,col[267])
    worksheet.write(rownum+51,1,col[268])
    worksheet.write(rownum+52,1,col[269])
    worksheet.write(rownum+53,1,col[270])
    worksheet.write(rownum+54,1,col[271])
    worksheet.write(rownum+55,1,col[272])
    worksheet.write(rownum+56,1,col[273])
    worksheet.write(rownum+57,1,col[274])
    worksheet.write(rownum+58,1,col[275])
    worksheet.write(rownum+59,1,col[276]) 
    worksheet.write(rownum+60,1,col[277])
    worksheet.write(rownum+61,1,col[278])
    worksheet.write(rownum+62,1,col[279])
    worksheet.write(rownum+63,1,col[280])
    worksheet.write(rownum+64,1,col[281])
    worksheet.write(rownum+65,1,col[282])
    worksheet.write(rownum+66,1,col[283])
    worksheet.write(rownum+67,1,col[284])
    worksheet.write(rownum+68,1,col[285])
    worksheet.write(rownum+69,1,col[286]) 
    worksheet.write(rownum+70,1,col[287]) 
    worksheet.write(rownum+71,1,col[288])
    worksheet.write(rownum+72,1,col[289])
    worksheet.write(rownum+73,1,col[290])
    worksheet.write(rownum+74,1,col[291])
    worksheet.write(rownum+75,1,col[292])
    worksheet.write(rownum+76,1,col[293])
    worksheet.write(rownum+77,1,col[294])
    worksheet.write(rownum+78,1,col[295])
    worksheet.write(rownum+79,1,col[296]) 
    worksheet.write(rownum+80,1,col[297]) 
    worksheet.write(rownum+81,1,col[298])
    worksheet.write(rownum+82,1,col[299])
    worksheet.write(rownum+83,1,col[300])
    worksheet.write(rownum+84,1,col[301])
    worksheet.write(rownum+85,1,col[302])
    worksheet.write(rownum+86,1,col[303])
    worksheet.write(rownum+87,1,col[304])
    worksheet.write(rownum+88,1,col[305])
    worksheet.write(rownum+89,1,col[306]) 
    worksheet.write(rownum+90,1,col[307]) 
    worksheet.write(rownum+91,1,col[308])
    worksheet.write(rownum+92,1,col[309])
    worksheet.write(rownum+93,1,col[310])
    worksheet.write(rownum+94,1,col[311])
    worksheet.write(rownum+95,1,col[312])
    worksheet.write(rownum+96,1,col[313])
    worksheet.write(rownum+97,1,col[314])
    worksheet.write(rownum+98,1,col[315])
    worksheet.write(rownum+99,1,col[316]) 
    worksheet.write(rownum+100,1,col[317]) 
    worksheet.write(rownum+101,1,col[318])
    worksheet.write(rownum+102,1,col[319])
    worksheet.write(rownum+103,1,col[320])
    worksheet.write(rownum+104,1,col[321])
    worksheet.write(rownum+105,1,col[322])
    worksheet.write(rownum+106,1,col[323])
    worksheet.write(rownum+107,1,col[324])
    worksheet.write(rownum+108,1,col[325])
    worksheet.write_formula('B110', '=B111-Sum(B2:B109)')
    worksheet.write(rownum+110,1,col[326])
#BYR Renewal numbers    
    worksheet.write(rownum+1,2,col[327])
    worksheet.write(rownum+2,2,col[328])
    worksheet.write(rownum+3,2,col[329])
    worksheet.write(rownum+4,2,col[330])
    worksheet.write(rownum+5,2,col[331])
    worksheet.write(rownum+6,2,col[332])
    worksheet.write(rownum+7,2,col[333])
    worksheet.write(rownum+8,2,col[334])
    worksheet.write(rownum+9,2,col[335]) 
    worksheet.write(rownum+10,2,col[336]) 
    worksheet.write(rownum+11,2,col[337])
    worksheet.write(rownum+12,2,col[338]) 
    worksheet.write(rownum+13,2,col[339])     
    worksheet.write(rownum+14,2,col[340])
    worksheet.write(rownum+15,2,col[341])    
    worksheet.write(rownum+16,2,col[342])
    worksheet.write(rownum+17,2,col[343])
    worksheet.write(rownum+18,2,col[344])
    worksheet.write(rownum+19,2,col[345])
    worksheet.write(rownum+20,2,col[346]) 
    worksheet.write(rownum+21,2,col[347]) 
    worksheet.write(rownum+22,2,col[348])
    worksheet.write(rownum+23,2,col[349])
    worksheet.write(rownum+24,2,col[350])
    worksheet.write(rownum+25,2,col[351])
    worksheet.write(rownum+26,2,col[352])
    worksheet.write(rownum+27,2,col[353])
    worksheet.write(rownum+28,2,col[354])
    worksheet.write(rownum+29,2,col[355]) 
    worksheet.write(rownum+30,2,col[356]) 
    worksheet.write(rownum+31,2,col[357])
    worksheet.write(rownum+32,2,col[358])
    worksheet.write(rownum+33,2,col[359])
    worksheet.write(rownum+34,2,col[360])
    worksheet.write(rownum+35,2,col[361])
    worksheet.write(rownum+36,2,col[362])
    worksheet.write(rownum+37,2,col[363])
    worksheet.write(rownum+38,2,col[364])
    worksheet.write(rownum+39,2,col[365]) 
    worksheet.write(rownum+40,2,col[366])
    worksheet.write(rownum+41,2,col[367])
    worksheet.write(rownum+42,2,col[368])
    worksheet.write(rownum+43,2,col[369])
    worksheet.write(rownum+44,2,col[370])
    worksheet.write(rownum+45,2,col[371])
    worksheet.write(rownum+46,2,col[372])
    worksheet.write(rownum+47,2,col[373])
    worksheet.write(rownum+48,2,col[374])
    worksheet.write(rownum+49,2,col[375]) 
    worksheet.write(rownum+50,2,col[376])
    worksheet.write(rownum+51,2,col[377])
    worksheet.write(rownum+52,2,col[378])
    worksheet.write(rownum+53,2,col[379])
    worksheet.write(rownum+54,2,col[380])
    worksheet.write(rownum+55,2,col[381])
    worksheet.write(rownum+56,2,col[382])
    worksheet.write(rownum+57,2,col[383])
    worksheet.write(rownum+58,2,col[384])
    worksheet.write(rownum+59,2,col[385]) 
    worksheet.write(rownum+60,2,col[386])
    worksheet.write(rownum+61,2,col[387])
    worksheet.write(rownum+62,2,col[388])
    worksheet.write(rownum+63,2,col[389])
    worksheet.write(rownum+64,2,col[390])
    worksheet.write(rownum+65,2,col[391])
    worksheet.write(rownum+66,2,col[392])
    worksheet.write(rownum+67,2,col[393])
    worksheet.write(rownum+68,2,col[394])
    worksheet.write(rownum+69,2,col[395]) 
    worksheet.write(rownum+70,2,col[396]) 
    worksheet.write(rownum+71,2,col[397])
    worksheet.write(rownum+72,2,col[398])
    worksheet.write(rownum+73,2,col[399])
    worksheet.write(rownum+74,2,col[400])
    worksheet.write(rownum+75,2,col[401])
    worksheet.write(rownum+76,2,col[402])
    worksheet.write(rownum+77,2,col[403])
    worksheet.write(rownum+78,2,col[404])
    worksheet.write(rownum+79,2,col[405]) 
    worksheet.write(rownum+80,2,col[406]) 
    worksheet.write(rownum+81,2,col[407])
    worksheet.write(rownum+82,2,col[408])
    worksheet.write(rownum+83,2,col[409])
    worksheet.write(rownum+84,2,col[410])
    worksheet.write(rownum+85,2,col[411])
    worksheet.write(rownum+86,2,col[412])
    worksheet.write(rownum+87,2,col[413])
    worksheet.write(rownum+88,2,col[414])
    worksheet.write(rownum+89,2,col[415]) 
    worksheet.write(rownum+90,2,col[416]) 
    worksheet.write(rownum+91,2,col[417])
    worksheet.write(rownum+92,2,col[418])
    worksheet.write(rownum+93,2,col[419])
    worksheet.write(rownum+94,2,col[420])
    worksheet.write(rownum+95,2,col[421])
    worksheet.write(rownum+96,2,col[422])
    worksheet.write(rownum+97,2,col[423])
    worksheet.write(rownum+98,2,col[424])
    worksheet.write(rownum+99,2,col[425]) 
    worksheet.write(rownum+100,2,col[426]) 
    worksheet.write(rownum+101,2,col[427])
    worksheet.write(rownum+102,2,col[428])
    worksheet.write(rownum+103,2,col[429])
    worksheet.write(rownum+104,2,col[430])
    worksheet.write(rownum+105,2,col[431])
    worksheet.write(rownum+106,2,col[432])
    worksheet.write(rownum+107,2,col[433])
    worksheet.write(rownum+108,2,col[434])
    worksheet.write_formula('C110', '=C111-Sum(C2:C109)')
    worksheet.write(rownum+110,2,col[435])

worksheet.set_landscape()
worksheet.hide_gridlines(0)


worksheet = workbook.add_worksheet('Cos Cob')


worksheet.set_landscape()
worksheet.hide_gridlines(0)


eformat= workbook.add_format({'text_wrap': True, 'valign': 'top' , 'num_format': 'mm/dd/yy'})
eformatlabel= workbook.add_format({'text_wrap': False, 'valign': 'top', 'bold': True})
    
worksheet.set_header('Cos Cob')



worksheet.set_column(0,0,29)
worksheet.set_column(1,1,10)
worksheet.set_column(2,2,10)

worksheet.write(0,1,'Checkouts', eformatlabel)
worksheet.write(0,2,'Renewals', eformatlabel)
#Cos Cob Checkout numbers
worksheet.write(0,1,'Checkouts', eformatlabel)
worksheet.write(0,2,'Renewals', eformatlabel)
worksheet.write(1,0,'000-099', eformatlabel)
worksheet.write(2,0,'100-149', eformatlabel)
worksheet.write(3,0,'150-159', eformatlabel)
worksheet.write(4,0,'160-199', eformatlabel)
worksheet.write(5,0,'200-299', eformatlabel)
worksheet.write(6,0,'300-309', eformatlabel)
worksheet.write(7,0,'320-329', eformatlabel)
worksheet.write(8,0,'330-339', eformatlabel)
worksheet.write(9,0,'340-349', eformatlabel)
worksheet.write(10,0,'350-359', eformatlabel)
worksheet.write(11,0,'360-369', eformatlabel)
worksheet.write(12,0,'370-379', eformatlabel)
worksheet.write(13,0,'380-389', eformatlabel)
worksheet.write(14,0,'390-399', eformatlabel)
worksheet.write(15,0,'400-499', eformatlabel)
worksheet.write(16,0,'500-599,310-319', eformatlabel)
worksheet.write(17,0,'600-619', eformatlabel)
worksheet.write(18,0,'620-629', eformatlabel)
worksheet.write(19,0,'630-635', eformatlabel)
worksheet.write(20,0,'636-669', eformatlabel)
worksheet.write(21,0,'640-642', eformatlabel)
worksheet.write(22,0,'643-648', eformatlabel)
worksheet.write(23,0,'649', eformatlabel)
worksheet.write(24,0,'650-659', eformatlabel)
worksheet.write(25,0,'660-699', eformatlabel)
worksheet.write(26,0,'700-709', eformatlabel)
worksheet.write(27,0,'710-719', eformatlabel)
worksheet.write(28,0,'720-769', eformatlabel)
worksheet.write(29,0,'770-779', eformatlabel)
worksheet.write(30,0,'780-789', eformatlabel)
worksheet.write(31,0,'Music Scores', eformatlabel)
worksheet.write(32,0,'790-792', eformatlabel)
worksheet.write(33,0,'793-799', eformatlabel)
worksheet.write(34,0,'800-819', eformatlabel)
worksheet.write(35,0,'820-829', eformatlabel)
worksheet.write(36,0,'830-899', eformatlabel)
worksheet.write(37,0,'900-909', eformatlabel)
worksheet.write(38,0,'910-919', eformatlabel)
worksheet.write(39,0,'920-929', eformatlabel)
worksheet.write(40,0,'930-969', eformatlabel)
worksheet.write(41,0,'970-999', eformatlabel)
worksheet.write(42,0,'Fiction', eformatlabel)
worksheet.write(43,0,'Express', eformatlabel)
worksheet.write(44,0,'Adult Graphic Novel', eformatlabel)
worksheet.write(45,0,'Mystery', eformatlabel)
worksheet.write(46,0,'Science Fiction', eformatlabel)
worksheet.write(47,0,'Short Stories', eformatlabel)
worksheet.write(48,0,'Large Print', eformatlabel)
worksheet.write(49,0,'Chinese', eformatlabel)
worksheet.write(50,0,'French', eformatlabel)
worksheet.write(51,0,'German', eformatlabel)
worksheet.write(52,0,'Italian', eformatlabel)
worksheet.write(53,0,'Japanese', eformatlabel)
worksheet.write(54,0,'Spanish', eformatlabel)
worksheet.write(55,0,'Paperback Fiction', eformatlabel)
worksheet.write(56,0,'Paperback Mystery', eformatlabel)
worksheet.write(57,0,'Paperback Romance', eformatlabel)
worksheet.write(58,0,'Paperback Non-Fiction', eformatlabel)
worksheet.write(59,0,'YA Fiction', eformatlabel)
worksheet.write(60,0,'YA Non-Fiction', eformatlabel)
worksheet.write(61,0,'YA Manga', eformatlabel)
worksheet.write(62,0,'YA Graphic Novels', eformatlabel)
worksheet.write(63,0,'YA COMP DISC Spoken Word', eformatlabel)
worksheet.write(64,0,'Adult COMP DISC Spoken Word', eformatlabel)
worksheet.write(65,0,'Downloadable Audiobook', eformatlabel)
worksheet.write(66,0,'Downloadable Music', eformatlabel)
worksheet.write(67,0,'Adult COMP DISC Music', eformatlabel)
worksheet.write(68,0,'Adult DVDs', eformatlabel)
worksheet.write(69,0,'Downloadable Video', eformatlabel)
worksheet.write(70,0,'Adult & YA Games', eformatlabel)
worksheet.write(71,0,'Interlibrary Loan', eformatlabel)
worksheet.write(72,0,'Language Learning', eformatlabel)
worksheet.write(73,0,'Local History', eformatlabel)
worksheet.write(74,0,'J 000-099', eformatlabel)
worksheet.write(75,0,'J 100-199', eformatlabel)
worksheet.write(76,0,'J 200-299', eformatlabel)
worksheet.write(77,0,'J 300-399', eformatlabel)
worksheet.write(78,0,'J 400-499', eformatlabel)
worksheet.write(79,0,'J 500-599', eformatlabel)
worksheet.write(80,0,'J 600-699', eformatlabel)
worksheet.write(81,0,'J 700-799', eformatlabel)
worksheet.write(82,0,'J 800-899', eformatlabel)
worksheet.write(83,0,'J 900-999', eformatlabel)
worksheet.write(84,0,'J Biography', eformatlabel)
worksheet.write(85,0,'J Fiction', eformatlabel)
worksheet.write(86,0,'E Books and Boardbooks', eformatlabel)
worksheet.write(87,0,'J Paperback', eformatlabel)
worksheet.write(88,0,'J COMP DISC Spoken Word', eformatlabel)
worksheet.write(89,0,'J COMP DISC Music', eformatlabel)
worksheet.write(90,0,'J Multimedia Kit', eformatlabel)
worksheet.write(91,0,'J Magazine', eformatlabel)
worksheet.write(92,0,'Reference Adult', eformatlabel)
worksheet.write(93,0,'Juvenile Reference', eformatlabel)
worksheet.write(94,0,'Oral History Transcripts', eformatlabel)
worksheet.write(95,0,'J DVDs', eformatlabel)
worksheet.write(96,0,'J Games', eformatlabel)
worksheet.write(97,0,'J Parent Corner', eformatlabel)
worksheet.write(98,0,'J German', eformatlabel)
worksheet.write(99,0,'J Italian', eformatlabel)
worksheet.write(100,0,'J Chinese', eformatlabel)
worksheet.write(101,0,'J French', eformatlabel)
worksheet.write(102,0,'J Japanese', eformatlabel)
worksheet.write(103,0,'J Spanish', eformatlabel)
worksheet.write(104,0,'J Language Learning', eformatlabel)
worksheet.write(105,0,'e Books', eformatlabel)
worksheet.write(106,0,'Adult Circulating Periodicals', eformatlabel)
worksheet.write(107,0,'Lending Art', eformatlabel)
worksheet.write(108,0,'Museum Pass', eformatlabel)
worksheet.write(109,0,'Not in table', eformatlabel)
worksheet.write(110,0,'Total', eformatlabel)

for rownum, col in enumerate(rows):
    worksheet.write(rownum+1,1,col[436])
    worksheet.write(rownum+2,1,col[437])
    worksheet.write(rownum+3,1,col[438])
    worksheet.write(rownum+4,1,col[439])
    worksheet.write(rownum+5,1,col[440])
    worksheet.write(rownum+6,1,col[441])
    worksheet.write(rownum+7,1,col[442])
    worksheet.write(rownum+8,1,col[443])
    worksheet.write(rownum+9,1,col[444]) 
    worksheet.write(rownum+10,1,col[445]) 
    worksheet.write(rownum+11,1,col[446])
    worksheet.write(rownum+12,1,col[447]) 
    worksheet.write(rownum+13,1,col[448])     
    worksheet.write(rownum+14,1,col[449])    
    worksheet.write(rownum+15,1,col[450])
    worksheet.write(rownum+16,1,col[451])
    worksheet.write(rownum+17,1,col[452])
    worksheet.write(rownum+18,1,col[453])
    worksheet.write(rownum+19,1,col[454]) 
    worksheet.write(rownum+20,1,col[455]) 
    worksheet.write(rownum+21,1,col[456])
    worksheet.write(rownum+22,1,col[457])
    worksheet.write(rownum+23,1,col[458])
    worksheet.write(rownum+24,1,col[459])
    worksheet.write(rownum+25,1,col[460])
    worksheet.write(rownum+26,1,col[461])
    worksheet.write(rownum+27,1,col[462])
    worksheet.write(rownum+28,1,col[463])
    worksheet.write(rownum+29,1,col[464]) 
    worksheet.write(rownum+30,1,col[465]) 
    worksheet.write(rownum+31,1,col[466])
    worksheet.write(rownum+32,1,col[467])
    worksheet.write(rownum+33,1,col[468])
    worksheet.write(rownum+34,1,col[469])
    worksheet.write(rownum+35,1,col[470])
    worksheet.write(rownum+36,1,col[471])
    worksheet.write(rownum+37,1,col[472])
    worksheet.write(rownum+38,1,col[473])
    worksheet.write(rownum+39,1,col[474]) 
    worksheet.write(rownum+40,1,col[475])
    worksheet.write(rownum+41,1,col[476])
    worksheet.write(rownum+42,1,col[477])
    worksheet.write(rownum+43,1,col[478])
    worksheet.write(rownum+44,1,col[479])
    worksheet.write(rownum+45,1,col[480])
    worksheet.write(rownum+46,1,col[481])
    worksheet.write(rownum+47,1,col[482])
    worksheet.write(rownum+48,1,col[483])
    worksheet.write(rownum+49,1,col[484]) 
    worksheet.write(rownum+50,1,col[485])
    worksheet.write(rownum+51,1,col[486])
    worksheet.write(rownum+52,1,col[487])
    worksheet.write(rownum+53,1,col[488])
    worksheet.write(rownum+54,1,col[489])
    worksheet.write(rownum+55,1,col[490])
    worksheet.write(rownum+56,1,col[491])
    worksheet.write(rownum+57,1,col[492])
    worksheet.write(rownum+58,1,col[493])
    worksheet.write(rownum+59,1,col[494]) 
    worksheet.write(rownum+60,1,col[495])
    worksheet.write(rownum+61,1,col[496])
    worksheet.write(rownum+62,1,col[497])
    worksheet.write(rownum+63,1,col[498])
    worksheet.write(rownum+64,1,col[499])
    worksheet.write(rownum+65,1,col[500])
    worksheet.write(rownum+66,1,col[501])
    worksheet.write(rownum+67,1,col[502])
    worksheet.write(rownum+68,1,col[503])
    worksheet.write(rownum+69,1,col[504]) 
    worksheet.write(rownum+70,1,col[505]) 
    worksheet.write(rownum+71,1,col[506])
    worksheet.write(rownum+72,1,col[507])
    worksheet.write(rownum+73,1,col[508])
    worksheet.write(rownum+74,1,col[509])
    worksheet.write(rownum+75,1,col[510])
    worksheet.write(rownum+76,1,col[511])
    worksheet.write(rownum+77,1,col[512])
    worksheet.write(rownum+78,1,col[513])
    worksheet.write(rownum+79,1,col[514]) 
    worksheet.write(rownum+80,1,col[515]) 
    worksheet.write(rownum+81,1,col[516])
    worksheet.write(rownum+82,1,col[517])
    worksheet.write(rownum+83,1,col[518])
    worksheet.write(rownum+84,1,col[519])
    worksheet.write(rownum+85,1,col[520])
    worksheet.write(rownum+86,1,col[521])
    worksheet.write(rownum+87,1,col[522])
    worksheet.write(rownum+88,1,col[523])
    worksheet.write(rownum+89,1,col[524]) 
    worksheet.write(rownum+90,1,col[525]) 
    worksheet.write(rownum+91,1,col[526])
    worksheet.write(rownum+92,1,col[527])
    worksheet.write(rownum+93,1,col[528])
    worksheet.write(rownum+94,1,col[529])
    worksheet.write(rownum+95,1,col[530])
    worksheet.write(rownum+96,1,col[531])
    worksheet.write(rownum+97,1,col[532])
    worksheet.write(rownum+98,1,col[533])
    worksheet.write(rownum+99,1,col[534]) 
    worksheet.write(rownum+100,1,col[535]) 
    worksheet.write(rownum+101,1,col[536])
    worksheet.write(rownum+102,1,col[537])
    worksheet.write(rownum+103,1,col[538])
    worksheet.write(rownum+104,1,col[539])
    worksheet.write(rownum+105,1,col[540])
    worksheet.write(rownum+106,1,col[541])
    worksheet.write(rownum+107,1,col[542])
    worksheet.write(rownum+108,1,col[543])
    worksheet.write_formula('B110', '=B111-Sum(B2:B109)')
    worksheet.write(rownum+110,1,col[544])

#Cos Cob renewal numbers
    worksheet.write(rownum+1,2,col[545])
    worksheet.write(rownum+2,2,col[546])
    worksheet.write(rownum+3,2,col[547])
    worksheet.write(rownum+4,2,col[548])
    worksheet.write(rownum+5,2,col[549])
    worksheet.write(rownum+6,2,col[550])
    worksheet.write(rownum+7,2,col[551])
    worksheet.write(rownum+8,2,col[552])
    worksheet.write(rownum+9,2,col[553]) 
    worksheet.write(rownum+10,2,col[554]) 
    worksheet.write(rownum+11,2,col[555])
    worksheet.write(rownum+12,2,col[556]) 
    worksheet.write(rownum+13,2,col[557])     
    worksheet.write(rownum+14,2,col[558])
    worksheet.write(rownum+15,2,col[559])    
    worksheet.write(rownum+16,2,col[560])
    worksheet.write(rownum+17,2,col[561])
    worksheet.write(rownum+18,2,col[562])
    worksheet.write(rownum+19,2,col[563])
    worksheet.write(rownum+20,2,col[564]) 
    worksheet.write(rownum+21,2,col[565]) 
    worksheet.write(rownum+22,2,col[566])
    worksheet.write(rownum+23,2,col[567])
    worksheet.write(rownum+24,2,col[568])
    worksheet.write(rownum+25,2,col[569])
    worksheet.write(rownum+26,2,col[570])
    worksheet.write(rownum+27,2,col[571])
    worksheet.write(rownum+28,2,col[572])
    worksheet.write(rownum+29,2,col[573]) 
    worksheet.write(rownum+30,2,col[574]) 
    worksheet.write(rownum+31,2,col[575])
    worksheet.write(rownum+32,2,col[576])
    worksheet.write(rownum+33,2,col[577])
    worksheet.write(rownum+34,2,col[578])
    worksheet.write(rownum+35,2,col[579])
    worksheet.write(rownum+36,2,col[580])
    worksheet.write(rownum+37,2,col[581])
    worksheet.write(rownum+38,2,col[582])
    worksheet.write(rownum+39,2,col[583]) 
    worksheet.write(rownum+40,2,col[584])
    worksheet.write(rownum+41,2,col[585])
    worksheet.write(rownum+42,2,col[586])
    worksheet.write(rownum+43,2,col[587])
    worksheet.write(rownum+44,2,col[588])
    worksheet.write(rownum+45,2,col[589])
    worksheet.write(rownum+46,2,col[590])
    worksheet.write(rownum+47,2,col[591])
    worksheet.write(rownum+48,2,col[592])
    worksheet.write(rownum+49,2,col[593]) 
    worksheet.write(rownum+50,2,col[594])
    worksheet.write(rownum+51,2,col[595])
    worksheet.write(rownum+52,2,col[596])
    worksheet.write(rownum+53,2,col[597])
    worksheet.write(rownum+54,2,col[598])
    worksheet.write(rownum+55,2,col[599])
    worksheet.write(rownum+56,2,col[600])
    worksheet.write(rownum+57,2,col[601])
    worksheet.write(rownum+58,2,col[602])
    worksheet.write(rownum+59,2,col[603]) 
    worksheet.write(rownum+60,2,col[604])
    worksheet.write(rownum+61,2,col[605])
    worksheet.write(rownum+62,2,col[606])
    worksheet.write(rownum+63,2,col[607])
    worksheet.write(rownum+64,2,col[608])
    worksheet.write(rownum+65,2,col[609])
    worksheet.write(rownum+66,2,col[610])
    worksheet.write(rownum+67,2,col[611])
    worksheet.write(rownum+68,2,col[612])
    worksheet.write(rownum+69,2,col[613]) 
    worksheet.write(rownum+70,2,col[614]) 
    worksheet.write(rownum+71,2,col[615])
    worksheet.write(rownum+72,2,col[616])
    worksheet.write(rownum+73,2,col[617])
    worksheet.write(rownum+74,2,col[618])
    worksheet.write(rownum+75,2,col[619])
    worksheet.write(rownum+76,2,col[620])
    worksheet.write(rownum+77,2,col[621])
    worksheet.write(rownum+78,2,col[622])
    worksheet.write(rownum+79,2,col[623]) 
    worksheet.write(rownum+80,2,col[624]) 
    worksheet.write(rownum+81,2,col[625])
    worksheet.write(rownum+82,2,col[626])
    worksheet.write(rownum+83,2,col[627])
    worksheet.write(rownum+84,2,col[628])
    worksheet.write(rownum+85,2,col[629])
    worksheet.write(rownum+86,2,col[630])
    worksheet.write(rownum+87,2,col[631])
    worksheet.write(rownum+88,2,col[632])
    worksheet.write(rownum+89,2,col[633]) 
    worksheet.write(rownum+90,2,col[634]) 
    worksheet.write(rownum+91,2,col[635])
    worksheet.write(rownum+92,2,col[636])
    worksheet.write(rownum+93,2,col[637])
    worksheet.write(rownum+94,2,col[638])
    worksheet.write(rownum+95,2,col[639])
    worksheet.write(rownum+96,2,col[640])
    worksheet.write(rownum+97,2,col[641])
    worksheet.write(rownum+98,2,col[642])
    worksheet.write(rownum+99,2,col[643]) 
    worksheet.write(rownum+100,2,col[644]) 
    worksheet.write(rownum+101,2,col[645])
    worksheet.write(rownum+102,2,col[646])
    worksheet.write(rownum+103,2,col[647])
    worksheet.write(rownum+104,2,col[648])
    worksheet.write(rownum+105,2,col[649])
    worksheet.write(rownum+106,2,col[650])
    worksheet.write(rownum+107,2,col[651])
    worksheet.write(rownum+108,2,col[652])
    worksheet.write_formula('C110', '=C111-Sum(C2:C109)')
    worksheet.write(rownum+110,2,col[653])
workbook.close()


#Creating the email message
msg = MIMEMultipart()
msg['From'] = emailfrom
if type(emailto) is list:
    msg['To'] = ','.join(emailto)
else:
    msg['To'] = emailto
msg['Date'] = formatdate(localtime = True)
msg['Subject'] = emailsubject
msg.attach (MIMEText(emailmessage))
part = MIMEBase('application', "octet-stream")
part.set_payload(open(excelfile,"rb").read())
encoders.encode_base64(part)
part.add_header('Content-Disposition','attachment; filename=%s' % excelfile)
msg.attach(part)

#Sending the email message
smtp = smtplib.SMTP(emailhost, emailport)
smtp.sendmail(emailfrom, emailto, msg.as_string())
smtp.quit()








